<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://kit.fontawesome.com/7c4ca0706d.js" crossorigin="anonymous"></script>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
        <link rel="icon" href="{{ url_for('static', filename='favicon.png') }}" type="image/png">
        <script>
          (g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})({
            key: "AIzaSyACQeQ8SDgA44of8xWmS9YbgH_hBp-QJw8",
            v: "weekly",
            // Use the 'v' parameter to indicate the version to use (weekly, beta, alpha, etc.).
            // Add other bootstrap parameters as needed, using camel case.
          });
        </script>
        <title>{% block title %}{% endblock %}</title>
    </head>
    <body>
        <div class="top-line"></div>
        <div class="likes-popup"> </div>
        <div class="options-popup">
          <div style="color: red; font-weight: bold;">Report</div>
          <div style="color: red; font-weight: bold;" class="delete-btn" data-toggle="modal" data-target="#deleteModal">Delete</div>
          <div class="options-editBtn">Edit</div>
          <div>Cancel</div>
        </div>
        <div class="overlay"></div>
        <div class="flash-messages">
          {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}">
                {{ message }}
              </div>
            {% endfor %}
          {% endif %}
          {% endwith %}
        </div>

        <div class="navbar">
          <a href="{{ url_for('main.home') }}"><img src="{{ url_for('static', filename='BIBIMHAK.png')}}" alt="Site Logo" class="logo"></a>
          
          <div class="search-bar">
            <i class="fas fa-search"></i>
            <form method="GET" action="{{ url_for('main.search')}}">
              <input id="main-search" type="search" name="q" placeholder="Search...">
              {% set type_paramater = request.args.get('type', '') %}
              {% if type_paramater %}
                <input type="hidden" name="type" value="{{ request.args.get('type', '') }}">
              {% endif %}
            </form>
          </div>  
          <div class="profile">
            <a href="{{ url_for('posts.inbox') }}">
              <div style="position: relative; display: inline-block;">
                <i class="fa-regular fa-message"></i>
                {% if not current_user.is_anonymous %}
                  {% set new_messages = current_user.new_messages() %}
                  {% if new_messages %}
                    <span id="message_count" class="badge" data-count="{{ new_messages }}">{{ new_messages }}</span>
                  {% else %}
                    <span id="message_count" class="badge" data-count="{{ new_messages }}" style="display: none;">{{ new_messages }}</span>
                  {% endif %}
                {% endif %}
              </div>
            </a>
            <div style="position: relative; display: inline-block;">
              <i id="notification-bell" class="fa-regular fa-bell"></i>
              {% if not current_user.is_anonymous %}
                {% set new_notifications = current_user.new_notifications() %}
                {% if new_notifications > 0 %}
                  <span id="notifications_count" class="badge" data-count="0">{{ new_notifications}}</span>
                {% endif %}
              {% endif %}
            </div>
           
            <div class="notif-dropdown" style="display: none;">
              <h5>Notifications</h5>
            </div>
            
            <div class="profile-pic">
                <img src="{{ url_for('static', filename='pics/' + current_user.image_file) }}" alt="User Profile">
                <div class="profile-dropdown">
                  <div class="header">
                    <img src="{{ url_for('static', filename='pics/' + current_user.image_file) }}" alt="User Profile">
                    <div>
                      <h5>{{ current_user.username }}</h5>
                      <p style="font-size: small;">{{ current_user.karma }} reputation</p>
                    </div>
                
                  </div>  
             
                  <hr>
                  <!-- Place other content here -->
                  <a href="{{ url_for('main.logout') }}" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                  </a>
                </div>
            </div>
          </div>
        </div>  
        
        <div class="wrapper">
            <div class="sidebar">
                <ul>
                  <li><a href="{{ url_for('main.home') }}"><i class="fa fa-house"></i><span>Home</span></a></li>
                  <li><a id="materials-link" href="#"><i class="fa fa-book"></i><span>Library</span></a></li>
                  <li><a class="sidebar-option" href="{{ url_for('materials.load_materials', level='elementary') }}"><i class="fa-solid fa-seedling"></i><span>Elementary</span></a></li>
                  <li><a class="sidebar-option" href="{{ url_for('materials.load_materials', level='middle') }}"><i class="fa fa-school"></i><span>Middle School</span></a></li>
                  <li><a class="sidebar-option" href="{{ url_for('materials.load_materials', level='high') }}"><i class="fa fa-graduation-cap"></i><span>High School</span></a></li>
                  <li><a class="sidebar-option" href="{{ url_for('materials.load_materials', level='camp') }}"><i class="fa fa-tent"></i><span>Camp</span></a></li>
                  <li><a class="sidebar-option" href="{{ url_for('materials.load_materials', level='games') }}"><i class="fa fa-gamepad"></i><span>Games</span></a></li>
                  
                  <li><a href="{{ url_for('materials.questions') }}"><i class="fa fa-chalkboard-user"></i><span>Questions</span></a></li>
                  <li><a href="{{ url_for('materials.forum') }}"><i class="fa-solid fa-globe"></i><span>Community</span></a></li>
                  <li><a href="{{ url_for('meetings.load_meetings') }}"><i class="fa fa-business-time "></i><span>Meetings</span></a></li>
                  <li><a href="{{ url_for('users.display_users') }}"><i class="fa fa-trophy"></i></i><span>Users</span></a></li>
                </ul> 
            </div>
            
            <div class="main-content">
                {% block content %}{% endblock content %}
            </div>

            <div >
              {% block announcement_bar %}{% endblock announcement_bar %}
            </div>
          </div>

          <footer>
            <div class="footer-content">
            
            </div>
          </footer>
         
          <!--Modal-->
          <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <div>
                    <h5 class="modal-title" id="deleteModalLabel">Delete post?</h5>
                    <p>Are you sure you want to delete this post?</p>
                  </div>
                
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                  <form class="delete-form" action="" method="POST">
                    <input class="btn btn-danger" type="submit" value="Delete">
                  </form>
                </div>
              </div>
            </div>
          </div>

        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    </body>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/notifications.js') }}"></script>
    <script src="{{ url_for('static', filename='js/flashMessages.js') }}"></script>
    <script src="{{ url_for('static', filename='js/profile_dropdown.js') }}"></script>
</html>
